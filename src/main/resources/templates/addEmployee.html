<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset = "UTF-8">
	<title>Thêm Nhân Viên</title>
	<style>
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #000000;
            border-radius: 3px;
            background-color: #f8f9fa;
            font-size: 16px;
            
        }

    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body>
	<h2>Thêm Nhân Viên</h2>
	<form id="employeeForm" th:action="@{/employee/save}" th:object="${Employee}" method="post">
		<table>
			<tr>
				<td>Họ và tên: </td>
				<td><input type="text" th:field="*{name}"/></td>
			</tr>
			<tr>
				<td>Email: </td>
				<td><input type="email" th:field="*{email}"/></td>
			</tr>
			<tr>
				<td>Số điện thoại: </td>
				<td><input type="text" th:field="*{phone}"/></td>
			</tr>
			<tr>
				<td>Địa chỉ: </td>
				<td>
					<select id="addressId" th:field="*{address1.id}"></select>
				</td>
			</tr>
		</table>
		
		<button type="submit">Lưu</button>
		<a th:href="@{/list}">Hủy</a>
	</form>
	<script>
	    $(document).ready(function() {
	        $.get("/api/address", function(data) {
	            let dropdown = $("#addressId");
	            dropdown.empty();
	            $.each(data, function(index, address) {
	                dropdown.append(`<option value="${address.id}">${address.city}, ${address.province}</option>`);
	            });
	        });
	        
	        $("#employeeForm").submit(function(e) {
	            e.preventDefault();
	            let name = $("#name").val().trim();
	            let email = $("#email").val().trim();
	            let phone = $("#phone").val().trim();
	            let addressId = $("#addressId").val();

	            let isValid = true;
	            $(".error").text("");

	            if (name.length < 3 || name.length > 50) {
	                $("#nameError").text("Tên phải từ 3 đến 50 ký tự!");
	                isValid = false;
	            }

	            let emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
	            if (!emailPattern.test(email)) {
	                $("#emailError").text("Email không hợp lệ!");
	                isValid = false;
	            }

	            let phonePattern = /^(0[3-9])+([0-9]{8})$/;
	            if (!phonePattern.test(phone)) {
	                $("#phoneError").text("Số điện thoại không hợp lệ!");
	                isValid = false;
	            }

	            if (!addressId) {
	                $("#addressError").text("Vui lòng chọn địa chỉ!");
	                isValid = false;
	            }

	            if (!isValid) return;
	            
	            });
	    });
	        
    </script>
</body>
</html>